# 大盘AI助手

Android 原生应用，实时跟踪 A 股三大指数（上证指数、深证成指、创业板指），并通过智谱 GLM-4 大模型进行大盘走势分析和操作建议。

## 核心功能

### 📊 实时行情监控
- **三大指数实时行情** — 1分钟自动刷新上证指数、深证成指、创业板指数
- **全量数据展示** — 点位、涨跌幅、涨跌点数、成交额、开盘/最高/最低/昨收
- **量能分析** — 自动计算并标识放量/缩量情况，显示成交额变化百分比
- **振幅监控** — 显示当日振幅区间，辅助判断市场波动

### 🤖 AI智能分析
- **大盘走势分析** — 每5分钟调用GLM-4分析市场情绪、趋势方向、风险等级
- **多维度研判** — 市场情绪（极度恐慌/谨慎/中性/乐观/狂热）、趋势方向（强势上涨/震荡上行/盘整/震荡下行/加速下跌）、风险等级（低/中/高）
- **操作建议** — 基于AI分析给出具体操作策略和仓位建议
- **置信度评估** — 每个分析结果包含置信度评分（0-100），高置信度自动推送通知

### 🎯 策略推荐系统
- **板块策略推荐** — 每5分钟分析热门板块，推荐具有上涨潜力的行业板块及龙头股票
- **开盘竞价策略** — 交易日9:00-9:25自动触发，分析集合竞价情况，捕捉游资动向，推荐竞价表现强势的标的
- **尾盘策略推荐** — 交易日14:30-15:00自动触发，分析尾盘资金动向，推荐尾盘拉升或低吸机会
- **游资情绪周期** — 智能识别市场情绪周期：冰点/修复/高潮/分化/退潮，辅助判断短线介入时机
- **风险提示** — 每个推荐包含风险等级、操作要点、止损位建议
- **点击跳转** — 点击推荐的具体股票，自动跳转到同花顺APP查看股票详情，方便快速下单

### 📰 市场资讯
- **实时新闻抓取** — 获取最新市场要闻、政策动态、行业资讯
- **新闻列表展示** — 支持查看详细新闻内容，辅助分析判断
- **AI融合分析** — 新闻内容自动作为AI分析的参考因素

### 🔔 智能通知
- **高置信度推送** — 置信度≥80%的分析结果自动推送通知
- **关键时段提醒** — 开盘竞价、尾盘策略自动触发时推送通知
- **前台服务保障** — 通过前台服务确保后台稳定运行，不被系统杀死

## 技术架构

```
MainActivity (UI层)
  ├── StockDataService (前台服务)
  │     └── MarketApi → 新浪财经 → 三大指数实时数据
  │
  ├── AIRecommendationService (前台服务)
  │     ├── GLM4Client → 智谱GLM-4 API
  │     ├── PromptLoader → 7种分析提示词模板
  │     └── 定时任务
  │           ├── 大盘分析 (5分钟)
  │           ├── 策略分析 (5分钟)
  │           ├── 竞价策略 (9:00-9:25)
  │           └── 尾盘策略 (14:30-15:00)
  │
  └── StockRepository → SharedPreferences → 数据持久化
```

| 模块                      | 说明                              |
| ------------------------- | --------------------------------- |
| `MarketIndex`             | 大盘指数数据模型，包含量能分析    |
| `MarketAnalysis`          | AI大盘分析结果模型                |
| `StrategyRecommendation`  | 策略推荐模型（板块/竞价/尾盘）    |
| `StockNews`               | 市场新闻模型                      |
| `MarketApi`               | 新浪财经指数数据抓取              |
| `GLM4Client`              | 智谱GLM-4 API调用封装             |
| `PromptLoader`            | 提示词模板加载器                  |
| `StockAppHelper`          | 股票APP跳转工具，支持跳转同花顺   |
| `StockDataService`        | 前台服务，1分钟循环抓取指数和新闻 |
| `AIRecommendationService` | 前台服务，定时AI分析和策略推荐    |
| `RecommendationActivity`  | 策略推荐详情页                    |

## 快速开始

### 1. 环境要求

- Android Studio / Gradle 8.2+
- JDK 17
- Android SDK 34 (minSdk 26)

### 2. 编译运行

```bash
./gradlew assembleDebug
```

### 3. 配置API密钥

1. 前往 [open.bigmodel.cn](https://open.bigmodel.cn/) 注册账号
2. 创建API密钥
3. 在APP右上角设置图标中输入密钥

### 4. 使用

1. 点击 **开始监控** 启动后台服务
2. 自动获取三大指数实时数据（1分钟刷新）
3. AI每5分钟输出大盘分析结果
4. AI每5分钟输出策略推荐（板块/竞价/尾盘）
5. 交易时段自动触发专项策略分析
6. 高置信度分析会推送通知
7. 点击各个卡片查看详细分析内容

## AI分析模式

应用内置7种专业分析提示词模板（位于`assets/prompts/`）：

| 提示词文件                  | 分析类型     | 触发时机           | 说明                                       |
| --------------------------- | ------------ | ------------------ | ------------------------------------------ |
| `market_analysis.txt`       | 大盘走势分析 | 每5分钟            | 分析三大指数情绪、趋势、风险，给出操作建议 |
| `sector_strategy.txt`       | 板块策略推荐 | 每5分钟            | 推荐热门板块及龙头股票，包含操作要点       |
| `auction_strategy.txt`      | 开盘竞价策略 | 交易日 9:00-9:25   | 分析集合竞价，捕捉游资动向，推荐强势标的   |
| `closing_strategy.txt`      | 尾盘策略推荐 | 交易日 14:30-15:00 | 分析尾盘资金动向，推荐拉升或低吸机会       |
| `hot_money_analysis.txt`    | 游资情绪分析 | 配合竞价/尾盘策略  | 识别市场情绪周期，判断短线介入时机         |
| `quantitative_analysis.txt` | 量化分析     | 配合大盘分析       | 量化指标计算，技术面综合研判               |
| `combined_analysis.txt`     | 综合策略分析 | 综合多维度信息     | 融合多个分析维度，输出综合研判             |

所有分析均基于GLM-4大模型，结合实时指数数据、量能变化、市场新闻等多维度信息进行智能研判。

## 功能特色

### 📈 量能智能分析
- 自动对比前一交易日成交额，计算放量/缩量百分比
- 结合涨跌幅，判断量价配合情况
- 量能异常自动标注，辅助捕捉资金动向

### ⏰ 智能定时策略
- **常规分析**：大盘分析5分钟、策略推荐5分钟自动执行
- **关键时段**：开盘竞价和尾盘策略在交易时段自动触发
- **每日限制**：关键时段策略每天仅自动执行一次，避免重复推送
- **手动刷新**：支持手动触发任意策略分析

### 🎨 直观UI设计
- 指数涨跌实时变色（红涨绿跌）
- 风险等级颜色标识（低风险绿色/中风险橙色/高风险红色）
- 置信度评分可视化
- 策略推荐卡片式展示，点击查看详情

### � 第三方APP联动
- **一键跳转同花顺** — 点击推荐的具体股票，自动跳转到同花顺APP查看股票详情
- **智能代码识别** — 自动识别股票代码格式（沪深市场），无需手动输入
- **快速下单** — 跳转后可在同花顺直接下单，缩短交易路径
- **关联个股跳转** — 板块推荐中的关联个股标签均可点击跳转

### �🔒 稳定可靠
- 前台服务机制，防止系统杀后台
- 错误处理与重试机制
- 数据持久化存储，应用重启不丢失
- 通知权限管理，确保重要信息送达

## 数据源

| 数据类型   | 数据源    | 更新频率    | 说明                                   |
| ---------- | --------- | ----------- | -------------------------------------- |
| 指数行情   | 新浪财经  | 1分钟       | 免费，包含点位/量能/开高低收等全量数据 |
| 大盘AI分析 | 智谱GLM-4 | 5分钟       | 需API密钥，市场情绪/趋势/风险研判      |
| 策略推荐   | 智谱GLM-4 | 5分钟       | 板块/竞价/尾盘多维度策略分析           |
| 竞价策略   | 智谱GLM-4 | 9:00-9:25   | 开盘前集合竞价专项分析                 |
| 尾盘策略   | 智谱GLM-4 | 14:30-15:00 | 收盘前资金动向专项分析                 |
| 市场新闻   | 可配置    | 1分钟       | 需自行对接新闻接口                     |

## 使用场景

### 📱 日常监控
适合盯盘用户，实时掌握三大指数动态，通过AI分析辅助判断市场方向，及时调整仓位。

### ⚡ 短线交易
- **集合竞价**：9:15-9:25获取竞价策略推荐，开盘前决策介入标的
- **盘中板块**：每5分钟刷新热门板块，捕捉轮动机会
- **尾盘低吸**：14:30-15:00获取尾盘策略，把握最后半小时的拉升或低吸机会

### 🎯 游资跟踪
通过游资情绪周期识别和竞价/尾盘策略，捕捉短线资金动向，判断介入退出时机。

### 📊 趋势研判
结合大盘分析的市场情绪、趋势方向、风险等级，制定中长期投资策略。

## 注意事项

⚠️ **风险提示**
- 本应用仅供学习研究使用，不构成投资建议
- AI分析结果基于历史数据和算法模型，不保证准确性
- 股市有风险，投资需谨慎，请独立判断和决策

⚠️ **技术限制**
- 指数数据来自新浪财经，可能存在延迟或不准确
- GLM-4 API需要网络连接，离线状态下无法进行AI分析
- API调用有频率和额度限制，请合理使用
- 新闻接口需自行对接，默认为空
- 股票跳转功能需安装同花顺APP（com.hexin.plat.android），未安装时会提示

⚠️ **权限说明**
- 通知权限：用于推送重要分析结果
- 前台服务权限：保证后台持续运行
- 网络权限：获取行情数据和调用AI接口

## 依赖

- OkHttp 4.12 — 网络请求
- Gson 2.10 — JSON解析
- Material Components — UI组件
- MPAndroidChart — 图表（预留）

## License

MIT
